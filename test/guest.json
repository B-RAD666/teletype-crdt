{"history":[["applyRemote",{"type":"insert","opId":{"site":1,"seq":1},"text":"const assert = require('assert')\nconst {CompositeDisposable, Emitter} = require('event-kit')\nconst {NetworkMember, NetworkMessage} = require('./real-time_pb')\nconst convertToProtobufCompatibleBuffer = require('./convert-to-protobuf-compatible-buffer')\n\nmodule.exports =\nclass StarOverlayNetwork {\n  constructor ({id, peerPool, isHub}) {\n    this.id = id\n    this.peerPool = peerPool\n    this.isHub = isHub\n    if (this.isHub) this.spokes = new Set()\n    this.members = new Map() // TODO Rename `members` to something like \"membersByPeerId\"\n    this.members.set(this.getPeerId(), this.peerPool.getUser(this.getPeerId())) // TODO Consider moving this to a fn, since same this logic exists in multiple places in this class\n    this.emitter = new Emitter()\n\n    this.subscriptions = new CompositeDisposable(\n      peerPool.onDisconnection(this.didLoseConnectionToPeer.bind(this)),\n      peerPool.onReceive(this.receive.bind(this))\n    )\n  }\n\n  dispose () {\n    this.subscriptions.dispose()\n    this.disconnect()\n  }\n\n  connectTo (hubId) {\n    assert(!this.isHub, 'The hub should only receive connections')\n    assert(!this.hubId, 'Can connect to hub only once')\n    return new Promise(async (resolve) => {\n      this.resolveConnectionPromise = resolve\n\n      this.hubId = hubId\n      await this.peerPool.connectTo(this.hubId)\n\n      const starConnection = new NetworkMessage.StarConnection()\n      starConnection.setSenderId(this.getPeerId())\n      const networkMessage = new NetworkMessage()\n      networkMessage.setStarConnection(starConnection)\n      networkMessage.setNetworkId(this.id)\n\n      this.peerPool.send(this.hubId, networkMessage.serializeBinary())\n    })\n  }\n\n  disconnect () {\n    if (!this.connected) return\n\n    const starDisconnection = new NetworkMessage.StarDisconnection()\n    starDisconnection.setSenderId(this.getPeerId())\n    starDisconnection.setConnectionLost(false)\n    const networkMessage = new NetworkMessage()\n    networkMessage.setStarDisconnection(starDisconnection)\n    networkMessage.setNetworkId(this.id)\n\n    if (this.isHub) {\n      this.forwardBroadcast(this.getPeerId(), networkMessage.serializeBinary())\n      this.spokes.clear()\n    } else {\n      this.peerPool.send(this.hubId, networkMessage.serializeBinary())\n      this.hubId = null\n    }\n\n    this.members.set(this.getPeerId(), this.peerPool.getUser(this.getPeerId()))\n    this.connected = false\n  }\n\n  unicast (recipientId, message) {\n    message = convertToProtobufCompatibleBuffer(message)\n\n    const starUnicast = new NetworkMessage.StarUnicast()\n    starUnicast.setSenderId(this.peerPool.peerId)\n    starUnicast.setRecipientId(recipientId)\n    starUnicast.setBody(message)\n    const networkMessage = new NetworkMessage()\n    networkMessage.setStarUnicast(starUnicast)\n    networkMessage.setNetworkId(this.id)\n    const rawNetworkMessage = networkMessage.serializeBinary()\n\n    if (this.isHub) {\n      this.forwardUnicast(recipientId, rawNetworkMessage)\n    } else {\n      this.peerPool.send(this.hubId, rawNetworkMessage)\n    }\n  }\n\n  broadcast (message) {\n    message = convertToProtobufCompatibleBuffer(message)\n\n    const starBroadcast = new NetworkMessage.StarBroadcast()\n    starBroadcast.setSenderId(this.peerPool.peerId)\n    starBroadcast.setBody(message)\n    const networkMessage = new NetworkMessage()\n    networkMessage.setStarBroadcast(starBroadcast)\n    networkMessage.setNetworkId(this.id)\n    const rawNetworkMessage = networkMessage.serializeBinary()\n\n    if (this.isHub) {\n      this.forwardBroadcast(this.peerPool.peerId, rawNetworkMessage)\n    } else {\n      this.peerPool.send(this.hubId, rawNetworkMessage)\n    }\n  }\n\n  onPeerJoin (callback) {\n    return this.emitter.on('join', callback)\n  }\n\n  onPeerLeave (callback) {\n    return this.emitter.on('leave', callback)\n  }\n\n  onReceive (callback) {\n    return this.emitter.on('receive', callback)\n  }\n\n  getMembers () {\n    const members = new Set()\n    this.members.forEach((user, peerId) => {\n      members.add({peerId, username: user.username})\n    })\n    return members\n  }\n\n  getPeerId () {\n    return this.peerPool.peerId\n  }\n\n  receive ({senderId, message}) {\n    const networkMessage = NetworkMessage.deserializeBinary(message)\n    if (networkMessage.getNetworkId() !== this.id) return\n\n    if (networkMessage.hasStarConnection()) {\n      this.receiveConnection(message, networkMessage.getStarConnection())\n    } else if (networkMessage.hasStarConnectionAck()) {\n      this.receiveConnectionAck(networkMessage.getStarConnectionAck())\n    } else if (networkMessage.hasStarDisconnection()) {\n      this.receiveDisconnection(message, networkMessage.getStarDisconnection())\n    } else if (networkMessage.hasStarUnicast()) {\n      this.receiveUnicast(message, networkMessage.getStarUnicast())\n    } else if (networkMessage.hasStarBroadcast()) {\n      this.receiveBroadcast(message, networkMessage.getStarBroadcast())\n    }\n  }\n\n  receiveConnection (rawMessage, connectionMessage) {\n    const senderId = connectionMessage.getSenderId()\n\n    if (this.isHub) {\n      this.connected = true\n      this.spokes.add(senderId)\n\n      const networkMembers = []\n      this.getMembers().forEach((member) => {\n        const networkMember = new NetworkMember()\n        networkMember.setPeerId(member.peerId)\n        networkMember.setUsername(member.username)\n        networkMembers.push(networkMember)\n      })\n\n      const connectionAck = new NetworkMessage.StarConnectionAck()\n      connectionAck.setMembersList(networkMembers)\n      const ackNetworkMessage = new NetworkMessage()\n      ackNetworkMessage.setNetworkId(this.id)\n      ackNetworkMessage.setStarConnectionAck(connectionAck)\n      this.peerPool.send(senderId, ackNetworkMessage.serializeBinary())\n\n      this.forwardBroadcast(senderId, rawMessage)\n    }\n\n    connectionMessage.getMember\n\n    this.members.set(senderId, this.peerPool.getUser(senderId))\n    this.emitter.emit('join', {peerId: senderId})\n  }\n\n  receiveConnectionAck (connectionAckMessage) {\n    assert(!this.isHub, 'Connection acknowledgments cannot be sent to the hub')\n    const networkMembers = connectionAckMessage.getMembersList()\n    for (let i = 0; i < networkMembers.length; i++) {\n      const networkMember = networkMembers[i]\n      this.members.set(networkMember.getPeerId(), this.peerPool.getUser(networkMember.getPeerId()))\n    }\n\n    this.resolveConnectionPromise()\n    this.resolveConnectionPromise = null\n    this.connected = true\n  }\n\n  didLoseConnectionToPeer ({peerId}) {\n    if (this.isHub) {\n      this.spokes.delete(peerId)\n\n      const starDisconnection = new NetworkMessage.StarDisconnection()\n      starDisconnection.setSenderId(peerId)\n      starDisconnection.setConnectionLost(true)\n      const networkMessage = new NetworkMessage()\n      networkMessage.setStarDisconnection(starDisconnection)\n      networkMessage.setNetworkId(this.id)\n      this.forwardBroadcast(peerId, networkMessage.serializeBinary())\n    }\n\n    this.handleDisconnection(peerId, true)\n  }\n\n  receiveDisconnection (rawMessage, disconnectionMessage) {\n    const peerId = disconnectionMessage.getSenderId()\n    if (this.isHub) {\n      this.spokes.delete(peerId)\n      this.forwardBroadcast(peerId, rawMessage)\n    }\n\n    this.handleDisconnection(peerId, disconnectionMessage.getConnectionLost())\n  }\n\n  receiveUnicast (rawMessage, unicastMessage) {\n    const recipientId = unicastMessage.getRecipientId()\n    if (recipientId === this.peerPool.peerId) {\n      this.emitter.emit('receive', {\n        senderId: unicastMessage.getSenderId(),\n        message: convertToProtobufCompatibleBuffer(unicastMessage.getBody())\n      })\n    } else if (this.isHub) {\n      this.forwardUnicast(recipientId, rawMessage)\n    } else {\n      throw new Error('Received a unicast not intended for this peer')\n    }\n  }\n\n  receiveBroadcast (rawMessage, broadcastMessage) {\n    const senderId = broadcastMessage.getSenderId()\n    if (this.isHub) this.forwardBroadcast(senderId, rawMessage)\n    this.emitter.emit('receive', {\n      senderId,\n      message: convertToProtobufCompatibleBuffer(broadcastMessage.getBody())\n    })\n  }\n\n  forwardUnicast (recipientId, rawMessage) {\n    if (this.spokes.has(recipientId)) {\n      this.peerPool.send(recipientId, rawMessage)\n    }\n  }\n\n  forwardBroadcast (senderId, rawMessage) {\n    this.spokes.forEach((peerId) => {\n      if (peerId !== senderId) {\n        this.peerPool.send(peerId, rawMessage)\n      }\n    })\n  }\n\n  handleDisconnection (peerId, connectionLost) {\n    if (peerId === this.hubId) {\n      this.hubId = null\n      this.connected = false\n      this.members.set(this.getPeerId(), this.peerPool.getUser(this.getPeerId()))\n    } else {\n      this.members.delete(peerId)\n    }\n\n    this.emitter.emit('leave', {peerId, connectionLost})\n  }\n}\n","leftDependencyId":{"site":0,"seq":0},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":0,"seq":1},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":2},"text":"\n","leftDependencyId":{"site":1,"seq":1},"offsetInLeftDependency":{"row":167,"column":0},"rightDependencyId":{"site":1,"seq":1},"offsetInRightDependency":{"row":167,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":3},"text":"\n","leftDependencyId":{"site":1,"seq":2},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":1},"offsetInRightDependency":{"row":167,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":4},"text":"      ","leftDependencyId":{"site":1,"seq":2},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":5},"text":"N","leftDependencyId":{"site":1,"seq":4},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":6},"text":"e","leftDependencyId":{"site":1,"seq":5},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":7},"text":"t","leftDependencyId":{"site":1,"seq":6},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":8},"text":"w","leftDependencyId":{"site":1,"seq":7},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":9},"text":"o","leftDependencyId":{"site":1,"seq":8},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":10},"text":"r","leftDependencyId":{"site":1,"seq":9},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":11},"text":"k","leftDependencyId":{"site":1,"seq":10},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":12},"text":"M","leftDependencyId":{"site":1,"seq":11},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":13},"text":"e","leftDependencyId":{"site":1,"seq":12},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":14},"text":"s","leftDependencyId":{"site":1,"seq":13},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":15},"text":"s","leftDependencyId":{"site":1,"seq":14},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":16},"text":"a","leftDependencyId":{"site":1,"seq":15},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":17},"text":"g","leftDependencyId":{"site":1,"seq":16},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":18},"text":"e","leftDependencyId":{"site":1,"seq":17},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":19},"text":".","leftDependencyId":{"site":1,"seq":18},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":20},"text":"S","leftDependencyId":{"site":1,"seq":19},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":21},"text":"t","leftDependencyId":{"site":1,"seq":20},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":22},"text":"a","leftDependencyId":{"site":1,"seq":21},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":23},"text":"r","leftDependencyId":{"site":1,"seq":22},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":24},"text":"J","leftDependencyId":{"site":1,"seq":23},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":25},"text":"o","leftDependencyId":{"site":1,"seq":24},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":26},"text":"i","leftDependencyId":{"site":1,"seq":25},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":27},"leftDependencyId":{"site":1,"seq":20},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":26},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":26}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":28},"text":"StarJoinNotification","leftDependencyId":{"site":1,"seq":19},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":20},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":29},"text":"c","leftDependencyId":{"site":1,"seq":4},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":30},"text":"o","leftDependencyId":{"site":1,"seq":29},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":31},"text":"n","leftDependencyId":{"site":1,"seq":30},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":32},"text":"s","leftDependencyId":{"site":1,"seq":31},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":33},"text":"t","leftDependencyId":{"site":1,"seq":32},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":34},"text":" ","leftDependencyId":{"site":1,"seq":33},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":35},"text":"s","leftDependencyId":{"site":1,"seq":34},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":36},"text":"t","leftDependencyId":{"site":1,"seq":35},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":37},"text":"a","leftDependencyId":{"site":1,"seq":36},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":38},"text":"r","leftDependencyId":{"site":1,"seq":37},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":39},"text":"J","leftDependencyId":{"site":1,"seq":38},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":40},"text":"o","leftDependencyId":{"site":1,"seq":39},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":41},"text":"i","leftDependencyId":{"site":1,"seq":40},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":42},"text":"n","leftDependencyId":{"site":1,"seq":41},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":43},"text":"N","leftDependencyId":{"site":1,"seq":42},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":44},"text":"o","leftDependencyId":{"site":1,"seq":43},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":45},"text":"t","leftDependencyId":{"site":1,"seq":44},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":46},"text":"i","leftDependencyId":{"site":1,"seq":45},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":47},"text":"f","leftDependencyId":{"site":1,"seq":46},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":48},"text":"i","leftDependencyId":{"site":1,"seq":47},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":49},"text":"c","leftDependencyId":{"site":1,"seq":48},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":50},"text":"a","leftDependencyId":{"site":1,"seq":49},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":51},"text":"t","leftDependencyId":{"site":1,"seq":50},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":52},"text":"i","leftDependencyId":{"site":1,"seq":51},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":53},"text":"o","leftDependencyId":{"site":1,"seq":52},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":54},"text":"n","leftDependencyId":{"site":1,"seq":53},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":55},"text":" ","leftDependencyId":{"site":1,"seq":54},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":56},"text":"=","leftDependencyId":{"site":1,"seq":55},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":57},"text":" ","leftDependencyId":{"site":1,"seq":56},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":58},"text":"n","leftDependencyId":{"site":1,"seq":57},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":59},"text":"e","leftDependencyId":{"site":1,"seq":58},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":60},"text":"w","leftDependencyId":{"site":1,"seq":59},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":61},"text":" ","leftDependencyId":{"site":1,"seq":60},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":5},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":62},"text":"9","leftDependencyId":{"site":1,"seq":28},"offsetInLeftDependency":{"row":0,"column":20},"rightDependencyId":{"site":1,"seq":20},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":63},"text":")","leftDependencyId":{"site":1,"seq":62},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":20},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":64},"leftDependencyId":{"site":1,"seq":63},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":63},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":63}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":65},"leftDependencyId":{"site":1,"seq":62},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":62},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":62}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":66},"text":"()","leftDependencyId":{"site":1,"seq":28},"offsetInLeftDependency":{"row":0,"column":20},"rightDependencyId":{"site":1,"seq":62},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":67},"text":"\n","leftDependencyId":{"site":1,"seq":66},"offsetInLeftDependency":{"row":0,"column":2},"rightDependencyId":{"site":1,"seq":62},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":68},"text":"      ","leftDependencyId":{"site":1,"seq":67},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":62},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":69},"text":"d","leftDependencyId":{"site":1,"seq":68},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":62},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":70},"text":"s","leftDependencyId":{"site":1,"seq":69},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":62},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":71},"text":"k","leftDependencyId":{"site":1,"seq":70},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":62},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":72},"leftDependencyId":{"site":1,"seq":71},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":71},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":71}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":73},"leftDependencyId":{"site":1,"seq":70},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":70},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":70}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":74},"leftDependencyId":{"site":1,"seq":69},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":69},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":69}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":75},"text":"d","leftDependencyId":{"site":1,"seq":68},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":69},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":76},"text":"k","leftDependencyId":{"site":1,"seq":75},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":69},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":77},"leftDependencyId":{"site":1,"seq":76},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":76},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":76}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":78},"leftDependencyId":{"site":1,"seq":75},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":75},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":75}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":79},"text":"        const networkMember = new NetworkMember()\n        networkMember.setPeerId(member.peerId)\n        networkMember.setUsername(member.username)\n","leftDependencyId":{"site":1,"seq":67},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":68},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":80},"leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":0,"column":2},"maxSeqsBySite":{"1":79}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":81},"leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":1,"column":2},"maxSeqsBySite":{"1":79}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":82},"leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":2,"column":0},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":2},"maxSeqsBySite":{"1":79}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":83},"leftDependencyId":{"site":1,"seq":68},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":3},"offsetInRightDependency":{"row":1,"column":0},"maxSeqsBySite":{"1":76}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":84},"leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":1,"column":32},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":1,"column":45},"maxSeqsBySite":{"1":79}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":85},"leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":2,"column":34},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":49},"maxSeqsBySite":{"1":79}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":86},"text":"s","leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":1,"column":32},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":1,"column":32}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":87},"text":"e","leftDependencyId":{"site":1,"seq":86},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":1,"column":32}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":88},"text":"n","leftDependencyId":{"site":1,"seq":87},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":1,"column":32}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":89},"leftDependencyId":{"site":1,"seq":86},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":88},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":88}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":90},"text":"senderId","leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":1,"column":32},"rightDependencyId":{"site":1,"seq":86},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":91},"text":"this.peerPool.getUser(senderId)","leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":2,"column":34},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":34}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":92},"text":"\n","leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":2,"column":50},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":93},"text":"      ","leftDependencyId":{"site":1,"seq":92},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":94},"text":"c","leftDependencyId":{"site":1,"seq":93},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":95},"text":"o","leftDependencyId":{"site":1,"seq":94},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":96},"text":"n","leftDependencyId":{"site":1,"seq":95},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":97},"text":"s","leftDependencyId":{"site":1,"seq":96},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":98},"text":"e","leftDependencyId":{"site":1,"seq":97},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":99},"text":"t","leftDependencyId":{"site":1,"seq":98},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":2,"column":50}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":100},"leftDependencyId":{"site":1,"seq":99},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":99},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":99}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":101},"leftDependencyId":{"site":1,"seq":98},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":98}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":102},"text":"t","leftDependencyId":{"site":1,"seq":97},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":103},"text":" ","leftDependencyId":{"site":1,"seq":102},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":104},"text":"s","leftDependencyId":{"site":1,"seq":103},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":105},"text":"h","leftDependencyId":{"site":1,"seq":104},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":106},"text":"a","leftDependencyId":{"site":1,"seq":105},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":107},"text":"r","leftDependencyId":{"site":1,"seq":106},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":108},"text":"t","leftDependencyId":{"site":1,"seq":107},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":98},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":109},"leftDependencyId":{"site":1,"seq":4},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":67},"offsetInRightDependency":{"row":1,"column":0},"maxSeqsBySite":{"1":67}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":110},"leftDependencyId":{"site":1,"seq":93},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":79},"offsetInRightDependency":{"row":3,"column":0},"maxSeqsBySite":{"1":108}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":111},"text":"      const starJoinNotification = new NetworkMessage.StarJoinNotification()\n","leftDependencyId":{"site":1,"seq":92},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":93},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":112},"leftDependencyId":{"site":1,"seq":111},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":111},"offsetInRightDependency":{"row":1,"column":0},"maxSeqsBySite":{"1":111}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":113},"text":"      const shart\n","leftDependencyId":{"site":1,"seq":92},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":111},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":114},"text":"      const starJoinNotification = new NetworkMessage.StarJoinNotification()\n","leftDependencyId":{"site":1,"seq":2},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":4},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":115},"leftDependencyId":{"site":1,"seq":113},"offsetInLeftDependency":{"row":0,"column":12},"rightDependencyId":{"site":1,"seq":113},"offsetInRightDependency":{"row":0,"column":17},"maxSeqsBySite":{"1":113}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":116},"text":"s","leftDependencyId":{"site":1,"seq":113},"offsetInLeftDependency":{"row":0,"column":12},"rightDependencyId":{"site":1,"seq":113},"offsetInRightDependency":{"row":0,"column":12}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":117},"text":"t","leftDependencyId":{"site":1,"seq":116},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":113},"offsetInRightDependency":{"row":0,"column":12}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":118},"text":"a","leftDependencyId":{"site":1,"seq":117},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":113},"offsetInRightDependency":{"row":0,"column":12}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":119},"text":"r","leftDependencyId":{"site":1,"seq":118},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":113},"offsetInRightDependency":{"row":0,"column":12}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":120},"text":"t","leftDependencyId":{"site":1,"seq":119},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":113},"offsetInRightDependency":{"row":0,"column":12}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":121},"leftDependencyId":{"site":1,"seq":120},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":120}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":122},"text":"J","leftDependencyId":{"site":1,"seq":119},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":123},"text":"o","leftDependencyId":{"site":1,"seq":122},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":124},"text":"i","leftDependencyId":{"site":1,"seq":123},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":125},"text":"n","leftDependencyId":{"site":1,"seq":124},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":126},"text":"M","leftDependencyId":{"site":1,"seq":125},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":127},"text":"e","leftDependencyId":{"site":1,"seq":126},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":128},"text":"s","leftDependencyId":{"site":1,"seq":127},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":129},"text":"s","leftDependencyId":{"site":1,"seq":128},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":130},"text":"a","leftDependencyId":{"site":1,"seq":129},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":131},"text":"g","leftDependencyId":{"site":1,"seq":130},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":132},"text":"e","leftDependencyId":{"site":1,"seq":131},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":120},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":133},"leftDependencyId":{"site":1,"seq":132},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":132},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":132}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":134},"leftDependencyId":{"site":1,"seq":131},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":131},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":131}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":135},"leftDependencyId":{"site":1,"seq":130},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":130},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":130}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":136},"leftDependencyId":{"site":1,"seq":129},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":129},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":129}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":137},"leftDependencyId":{"site":1,"seq":128},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":128},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":128}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":138},"leftDependencyId":{"site":1,"seq":127},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":127},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":127}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":139},"leftDependencyId":{"site":1,"seq":126},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":126},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":126}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":140},"text":"n","leftDependencyId":{"site":1,"seq":125},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":126},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":141},"text":"e","leftDependencyId":{"site":1,"seq":140},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":126},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":142},"text":"t","leftDependencyId":{"site":1,"seq":141},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":126},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":143},"text":"w","leftDependencyId":{"site":1,"seq":142},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":126},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":144},"text":"o","leftDependencyId":{"site":1,"seq":143},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":126},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":145},"leftDependencyId":{"site":1,"seq":144},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":144},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":144}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":146},"leftDependencyId":{"site":1,"seq":143},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":143},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":143}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":147},"leftDependencyId":{"site":1,"seq":142},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":142},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":142}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":148},"leftDependencyId":{"site":1,"seq":141},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":141},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":141}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":149},"leftDependencyId":{"site":1,"seq":140},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":140}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":150},"text":"N","leftDependencyId":{"site":1,"seq":125},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":151},"text":"e","leftDependencyId":{"site":1,"seq":150},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":152},"text":"t","leftDependencyId":{"site":1,"seq":151},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":153},"text":"w","leftDependencyId":{"site":1,"seq":152},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":154},"text":"o","leftDependencyId":{"site":1,"seq":153},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":155},"text":"r","leftDependencyId":{"site":1,"seq":154},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":156},"text":"k","leftDependencyId":{"site":1,"seq":155},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":157},"text":"M","leftDependencyId":{"site":1,"seq":156},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":158},"text":"e","leftDependencyId":{"site":1,"seq":157},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":159},"text":"s","leftDependencyId":{"site":1,"seq":158},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":160},"text":"s","leftDependencyId":{"site":1,"seq":159},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":161},"text":"a","leftDependencyId":{"site":1,"seq":160},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":162},"text":"g","leftDependencyId":{"site":1,"seq":161},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":163},"text":"e","leftDependencyId":{"site":1,"seq":162},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":164},"text":" ","leftDependencyId":{"site":1,"seq":163},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":165},"text":"=","leftDependencyId":{"site":1,"seq":164},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":166},"text":" ","leftDependencyId":{"site":1,"seq":165},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":167},"text":"new NetworkMessage.StarJoinNotification()","leftDependencyId":{"site":1,"seq":166},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":168},"leftDependencyId":{"site":1,"seq":167},"offsetInLeftDependency":{"row":0,"column":19},"rightDependencyId":{"site":1,"seq":167},"offsetInRightDependency":{"row":0,"column":39},"maxSeqsBySite":{"1":167}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":169},"text":" ","leftDependencyId":{"site":1,"seq":167},"offsetInLeftDependency":{"row":0,"column":19},"rightDependencyId":{"site":1,"seq":167},"offsetInRightDependency":{"row":0,"column":19}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":170},"leftDependencyId":{"site":1,"seq":169},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":169},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":169}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":171},"text":"StarJoinNotification","leftDependencyId":{"site":1,"seq":167},"offsetInLeftDependency":{"row":0,"column":19},"rightDependencyId":{"site":1,"seq":169},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":172},"leftDependencyId":{"site":1,"seq":171},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":171},"offsetInRightDependency":{"row":0,"column":20},"maxSeqsBySite":{"1":171}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":173},"text":"d","leftDependencyId":{"site":1,"seq":167},"offsetInLeftDependency":{"row":0,"column":19},"rightDependencyId":{"site":1,"seq":171},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":174},"text":"h","leftDependencyId":{"site":1,"seq":173},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":171},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":175},"leftDependencyId":{"site":1,"seq":174},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":174},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":174}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":176},"leftDependencyId":{"site":1,"seq":173},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":173},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":173}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":177},"leftDependencyId":{"site":1,"seq":167},"offsetInLeftDependency":{"row":0,"column":18},"rightDependencyId":{"site":1,"seq":167},"offsetInRightDependency":{"row":0,"column":19},"maxSeqsBySite":{"1":167}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":178},"text":"f","leftDependencyId":{"site":1,"seq":167},"offsetInLeftDependency":{"row":0,"column":18},"rightDependencyId":{"site":1,"seq":167},"offsetInRightDependency":{"row":0,"column":18}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":179},"text":"h","leftDependencyId":{"site":1,"seq":178},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":167},"offsetInRightDependency":{"row":0,"column":18}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":180},"text":"h","leftDependencyId":{"site":1,"seq":179},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":167},"offsetInRightDependency":{"row":0,"column":18}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":181},"leftDependencyId":{"site":1,"seq":180},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":180},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":180}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":182},"leftDependencyId":{"site":1,"seq":179},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":179},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":179}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":183},"leftDependencyId":{"site":1,"seq":178},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":178},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":178}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":184},"text":"\n","leftDependencyId":{"site":1,"seq":167},"offsetInLeftDependency":{"row":0,"column":41},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":185},"text":"      ","leftDependencyId":{"site":1,"seq":184},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":186},"text":"s","leftDependencyId":{"site":1,"seq":185},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":187},"text":"t","leftDependencyId":{"site":1,"seq":186},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":188},"text":"a","leftDependencyId":{"site":1,"seq":187},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":189},"text":"r","leftDependencyId":{"site":1,"seq":188},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":140},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":190},"leftDependencyId":{"site":1,"seq":186},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":189},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":189}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":191},"text":"starJoinNetworkMessage","leftDependencyId":{"site":1,"seq":185},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":1},"text":"\n","leftDependencyId":{"site":1,"seq":79},"offsetInLeftDependency":{"row":2,"column":50},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":2},"text":"      ","leftDependencyId":{"site":2,"seq":1},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":192},"text":".","leftDependencyId":{"site":1,"seq":191},"offsetInLeftDependency":{"row":0,"column":22},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":3},"text":"s","leftDependencyId":{"site":2,"seq":2},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":4},"text":"t","leftDependencyId":{"site":2,"seq":3},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":5},"text":"a","leftDependencyId":{"site":2,"seq":4},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":6},"text":"r","leftDependencyId":{"site":2,"seq":5},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":7},"text":"J","leftDependencyId":{"site":2,"seq":6},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":8},"text":"o","leftDependencyId":{"site":2,"seq":7},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":9},"text":"i","leftDependencyId":{"site":2,"seq":8},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":10},"text":"n","leftDependencyId":{"site":2,"seq":9},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":193},"text":"s","leftDependencyId":{"site":1,"seq":192},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":194},"text":"e","leftDependencyId":{"site":1,"seq":193},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":11},"text":"N","leftDependencyId":{"site":2,"seq":10},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":195},"text":"t","leftDependencyId":{"site":1,"seq":194},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":12},"text":"o","leftDependencyId":{"site":2,"seq":11},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":13},"text":"t","leftDependencyId":{"site":2,"seq":12},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":14},"text":"i","leftDependencyId":{"site":2,"seq":13},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":196},"text":"N","leftDependencyId":{"site":1,"seq":195},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":15},"text":"f","leftDependencyId":{"site":2,"seq":14},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":197},"text":"e","leftDependencyId":{"site":1,"seq":196},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":16},"text":"i","leftDependencyId":{"site":2,"seq":15},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":17},"text":"c","leftDependencyId":{"site":2,"seq":16},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":198},"text":"t","leftDependencyId":{"site":1,"seq":197},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":18},"text":"a","leftDependencyId":{"site":2,"seq":17},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":199},"text":"w","leftDependencyId":{"site":1,"seq":198},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":19},"text":"t","leftDependencyId":{"site":2,"seq":18},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":20},"text":"i","leftDependencyId":{"site":2,"seq":19},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":21},"text":"o","leftDependencyId":{"site":2,"seq":20},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":200},"text":"o","leftDependencyId":{"site":1,"seq":199},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":22},"text":"n","leftDependencyId":{"site":2,"seq":21},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":201},"text":"r","leftDependencyId":{"site":1,"seq":200},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":202},"text":"k","leftDependencyId":{"site":1,"seq":201},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":23},"text":".","leftDependencyId":{"site":2,"seq":22},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":24},"text":"s","leftDependencyId":{"site":2,"seq":23},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":25},"text":"e","leftDependencyId":{"site":2,"seq":24},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":203},"text":"I","leftDependencyId":{"site":1,"seq":202},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":26},"text":"t","leftDependencyId":{"site":2,"seq":25},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":204},"text":"d","leftDependencyId":{"site":1,"seq":203},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":27},"text":"N","leftDependencyId":{"site":2,"seq":26},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":28},"text":"e","leftDependencyId":{"site":2,"seq":27},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":29},"text":"t","leftDependencyId":{"site":2,"seq":28},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":205},"text":"()","leftDependencyId":{"site":1,"seq":204},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":30},"text":"w","leftDependencyId":{"site":2,"seq":29},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":206},"text":"t","leftDependencyId":{"site":1,"seq":205},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":205},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":207},"text":"h","leftDependencyId":{"site":1,"seq":206},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":205},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":208},"text":"i","leftDependencyId":{"site":1,"seq":207},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":205},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":209},"text":"s","leftDependencyId":{"site":1,"seq":208},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":205},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":210},"text":".","leftDependencyId":{"site":1,"seq":209},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":205},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":31},"text":"o","leftDependencyId":{"site":2,"seq":30},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":32},"text":"r","leftDependencyId":{"site":2,"seq":31},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":33},"text":"k","leftDependencyId":{"site":2,"seq":32},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":211},"text":"i","leftDependencyId":{"site":1,"seq":210},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":205},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":212},"text":"d","leftDependencyId":{"site":1,"seq":211},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":205},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":34},"text":"M","leftDependencyId":{"site":2,"seq":33},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":35},"text":"e","leftDependencyId":{"site":2,"seq":34},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":213},"text":"\n","leftDependencyId":{"site":1,"seq":205},"offsetInLeftDependency":{"row":0,"column":2},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":214},"text":"      ","leftDependencyId":{"site":1,"seq":213},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":36},"text":"m","leftDependencyId":{"site":2,"seq":35},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":37},"text":"b","leftDependencyId":{"site":2,"seq":36},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":38},"text":"e","leftDependencyId":{"site":2,"seq":37},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":39},"text":"r","leftDependencyId":{"site":2,"seq":38},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":40},"text":"()","leftDependencyId":{"site":2,"seq":39},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":92},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":41},"text":"n","leftDependencyId":{"site":2,"seq":40},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":42},"text":"e","leftDependencyId":{"site":2,"seq":41},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":43},"text":"t","leftDependencyId":{"site":2,"seq":42},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":44},"text":"w","leftDependencyId":{"site":2,"seq":43},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":45},"text":"o","leftDependencyId":{"site":2,"seq":44},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":46},"text":"r","leftDependencyId":{"site":2,"seq":45},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":47},"text":"k","leftDependencyId":{"site":2,"seq":46},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":48},"text":"M","leftDependencyId":{"site":2,"seq":47},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":49},"text":"a","leftDependencyId":{"site":2,"seq":48},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":40},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"delete","opId":{"site":2,"seq":50},"leftDependencyId":{"site":2,"seq":49},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":2,"seq":49},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"2":49}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":51},"text":"e","leftDependencyId":{"site":2,"seq":48},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":49},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":52},"text":"m","leftDependencyId":{"site":2,"seq":51},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":49},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":53},"text":"b","leftDependencyId":{"site":2,"seq":52},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":49},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":54},"text":"e","leftDependencyId":{"site":2,"seq":53},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":49},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":2,"seq":55},"text":"r","leftDependencyId":{"site":2,"seq":54},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":2,"seq":49},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":215},"text":"s","leftDependencyId":{"site":1,"seq":214},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":216},"text":"t","leftDependencyId":{"site":1,"seq":215},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":217},"text":"a","leftDependencyId":{"site":1,"seq":216},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":218},"text":"r","leftDependencyId":{"site":1,"seq":217},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":186},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":219},"leftDependencyId":{"site":1,"seq":215},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":218},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":218}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":220},"text":"starJoinNetworkMessage","leftDependencyId":{"site":1,"seq":214},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":221},"text":".","leftDependencyId":{"site":1,"seq":220},"offsetInLeftDependency":{"row":0,"column":22},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":222},"text":"s","leftDependencyId":{"site":1,"seq":221},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":223},"text":"e","leftDependencyId":{"site":1,"seq":222},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":224},"text":"t","leftDependencyId":{"site":1,"seq":223},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":225},"text":"S","leftDependencyId":{"site":1,"seq":224},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":226},"text":"t","leftDependencyId":{"site":1,"seq":225},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":227},"text":"a","leftDependencyId":{"site":1,"seq":226},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":228},"text":"r","leftDependencyId":{"site":1,"seq":227},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":229},"text":"J","leftDependencyId":{"site":1,"seq":228},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":230},"text":"o","leftDependencyId":{"site":1,"seq":229},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":231},"text":"i","leftDependencyId":{"site":1,"seq":230},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":232},"text":"n","leftDependencyId":{"site":1,"seq":231},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":233},"text":"N","leftDependencyId":{"site":1,"seq":232},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":234},"text":"o","leftDependencyId":{"site":1,"seq":233},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":235},"text":"t","leftDependencyId":{"site":1,"seq":234},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":236},"text":"i","leftDependencyId":{"site":1,"seq":235},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":237},"text":"f","leftDependencyId":{"site":1,"seq":236},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":238},"text":"c","leftDependencyId":{"site":1,"seq":237},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":239},"text":"i","leftDependencyId":{"site":1,"seq":238},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":215},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":240},"leftDependencyId":{"site":1,"seq":239},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":239},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":239}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":241},"leftDependencyId":{"site":1,"seq":238},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":238}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":242},"text":"i","leftDependencyId":{"site":1,"seq":237},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":243},"text":"c","leftDependencyId":{"site":1,"seq":242},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":244},"text":"a","leftDependencyId":{"site":1,"seq":243},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":245},"text":"t","leftDependencyId":{"site":1,"seq":244},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":246},"text":"i","leftDependencyId":{"site":1,"seq":245},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":247},"text":"o","leftDependencyId":{"site":1,"seq":246},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":248},"text":"n","leftDependencyId":{"site":1,"seq":247},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":249},"text":"()","leftDependencyId":{"site":1,"seq":248},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":250},"text":"s","leftDependencyId":{"site":1,"seq":249},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":249},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":251},"text":"t","leftDependencyId":{"site":1,"seq":250},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":249},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":252},"text":"a","leftDependencyId":{"site":1,"seq":251},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":249},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":253},"text":"r","leftDependencyId":{"site":1,"seq":252},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":249},"offsetInRightDependency":{"row":0,"column":1}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":254},"leftDependencyId":{"site":1,"seq":250},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":253},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":253}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":255},"text":"starJoinNotification","leftDependencyId":{"site":1,"seq":249},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":250},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":256},"text":"\n","leftDependencyId":{"site":1,"seq":249},"offsetInLeftDependency":{"row":0,"column":2},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":257},"text":"      ","leftDependencyId":{"site":1,"seq":256},"offsetInLeftDependency":{"row":1,"column":0},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":258},"text":"t","leftDependencyId":{"site":1,"seq":257},"offsetInLeftDependency":{"row":0,"column":6},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":259},"text":"h","leftDependencyId":{"site":1,"seq":258},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":260},"text":"i","leftDependencyId":{"site":1,"seq":259},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":261},"text":"s","leftDependencyId":{"site":1,"seq":260},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":262},"text":" ","leftDependencyId":{"site":1,"seq":261},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":263},"text":".","leftDependencyId":{"site":1,"seq":262},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":264},"text":".","leftDependencyId":{"site":1,"seq":263},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":265},"text":".","leftDependencyId":{"site":1,"seq":264},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":266},"text":" ","leftDependencyId":{"site":1,"seq":265},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":267},"text":"s","leftDependencyId":{"site":1,"seq":266},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":268},"text":"t","leftDependencyId":{"site":1,"seq":267},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":269},"text":"a","leftDependencyId":{"site":1,"seq":268},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":270},"text":"r","leftDependencyId":{"site":1,"seq":269},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":238},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":271},"leftDependencyId":{"site":1,"seq":267},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":270},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":270}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":272},"text":"starJoinNetworkMessage","leftDependencyId":{"site":1,"seq":266},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":267},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":273},"text":".","leftDependencyId":{"site":1,"seq":272},"offsetInLeftDependency":{"row":0,"column":22},"rightDependencyId":{"site":1,"seq":267},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":274},"text":"s","leftDependencyId":{"site":1,"seq":273},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":267},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":275},"text":"e","leftDependencyId":{"site":1,"seq":274},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":267},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":276},"text":"r","leftDependencyId":{"site":1,"seq":275},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":267},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":277},"text":"l","leftDependencyId":{"site":1,"seq":276},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":267},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":278},"leftDependencyId":{"site":1,"seq":274},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":277},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":277}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":279},"text":"serializeBinary","leftDependencyId":{"site":1,"seq":273},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":274},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":280},"text":"()","leftDependencyId":{"site":1,"seq":279},"offsetInLeftDependency":{"row":0,"column":15},"rightDependencyId":{"site":1,"seq":274},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":281},"leftDependencyId":{"site":1,"seq":262},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":266},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":266}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":282},"leftDependencyId":{"site":1,"seq":262},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":280},"offsetInRightDependency":{"row":0,"column":2},"maxSeqsBySite":{"1":280}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":283},"text":"(starJoinNetworkMessage.serializeBinary())","leftDependencyId":{"site":1,"seq":261},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":262},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":284},"text":".","leftDependencyId":{"site":1,"seq":261},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":283},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":285},"text":"_","leftDependencyId":{"site":1,"seq":284},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":283},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":286},"text":"_","leftDependencyId":{"site":1,"seq":285},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":283},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"insert","opId":{"site":1,"seq":287},"text":"_","leftDependencyId":{"site":1,"seq":286},"offsetInLeftDependency":{"row":0,"column":1},"rightDependencyId":{"site":1,"seq":283},"offsetInRightDependency":{"row":0,"column":0}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":288},"leftDependencyId":{"site":1,"seq":287},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":287},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":287}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":289},"leftDependencyId":{"site":1,"seq":286},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":286},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":286}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":290},"leftDependencyId":{"site":1,"seq":285},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":285},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":285}}],["applyRemote",{"type":"delete","opId":{"site":1,"seq":291},"leftDependencyId":{"site":1,"seq":284},"offsetInLeftDependency":{"row":0,"column":0},"rightDependencyId":{"site":1,"seq":284},"offsetInRightDependency":{"row":0,"column":1},"maxSeqsBySite":{"1":284}}],["applyLocal",{"type":"delete","position":{"row":177,"column":15},"extent":{"row":0,"column":40}}],["applyLocal",{"type":"delete","position":{"row":178,"column":38},"extent":{"row":0,"column":10}}],["applyLocal",{"type":"insert","position":{"row":178,"column":38},"text":"starJoinNetworkMessage.serializeBinary()"}]],"siteId":3,"replicaText":"const assert = require('assert')\nconst {CompositeDisposable, Emitter} = require('event-kit')\nconst {NetworkMember, NetworkMessage} = require('./real-time_pb')\nconst convertToProtobufCompatibleBuffer = require('./convert-to-protobuf-compatible-buffer')\n\nmodule.exports =\nclass StarOverlayNetwork {\n  constructor ({id, peerPool, isHub}) {\n    this.id = id\n    this.peerPool = peerPool\n    this.isHub = isHub\n    if (this.isHub) this.spokes = new Set()\n    this.members = new Map() // TODO Rename `members` to something like \"membersByPeerId\"\n    this.members.set(this.getPeerId(), this.peerPool.getUser(this.getPeerId())) // TODO Consider moving this to a fn, since same this logic exists in multiple places in this class\n    this.emitter = new Emitter()\n\n    this.subscriptions = new CompositeDisposable(\n      peerPool.onDisconnection(this.didLoseConnectionToPeer.bind(this)),\n      peerPool.onReceive(this.receive.bind(this))\n    )\n  }\n\n  dispose () {\n    this.subscriptions.dispose()\n    this.disconnect()\n  }\n\n  connectTo (hubId) {\n    assert(!this.isHub, 'The hub should only receive connections')\n    assert(!this.hubId, 'Can connect to hub only once')\n    return new Promise(async (resolve) => {\n      this.resolveConnectionPromise = resolve\n\n      this.hubId = hubId\n      await this.peerPool.connectTo(this.hubId)\n\n      const starConnection = new NetworkMessage.StarConnection()\n      starConnection.setSenderId(this.getPeerId())\n      const networkMessage = new NetworkMessage()\n      networkMessage.setStarConnection(starConnection)\n      networkMessage.setNetworkId(this.id)\n\n      this.peerPool.send(this.hubId, networkMessage.serializeBinary())\n    })\n  }\n\n  disconnect () {\n    if (!this.connected) return\n\n    const starDisconnection = new NetworkMessage.StarDisconnection()\n    starDisconnection.setSenderId(this.getPeerId())\n    starDisconnection.setConnectionLost(false)\n    const networkMessage = new NetworkMessage()\n    networkMessage.setStarDisconnection(starDisconnection)\n    networkMessage.setNetworkId(this.id)\n\n    if (this.isHub) {\n      this.forwardBroadcast(this.getPeerId(), networkMessage.serializeBinary())\n      this.spokes.clear()\n    } else {\n      this.peerPool.send(this.hubId, networkMessage.serializeBinary())\n      this.hubId = null\n    }\n\n    this.members.set(this.getPeerId(), this.peerPool.getUser(this.getPeerId()))\n    this.connected = false\n  }\n\n  unicast (recipientId, message) {\n    message = convertToProtobufCompatibleBuffer(message)\n\n    const starUnicast = new NetworkMessage.StarUnicast()\n    starUnicast.setSenderId(this.peerPool.peerId)\n    starUnicast.setRecipientId(recipientId)\n    starUnicast.setBody(message)\n    const networkMessage = new NetworkMessage()\n    networkMessage.setStarUnicast(starUnicast)\n    networkMessage.setNetworkId(this.id)\n    const rawNetworkMessage = networkMessage.serializeBinary()\n\n    if (this.isHub) {\n      this.forwardUnicast(recipientId, rawNetworkMessage)\n    } else {\n      this.peerPool.send(this.hubId, rawNetworkMessage)\n    }\n  }\n\n  broadcast (message) {\n    message = convertToProtobufCompatibleBuffer(message)\n\n    const starBroadcast = new NetworkMessage.StarBroadcast()\n    starBroadcast.setSenderId(this.peerPool.peerId)\n    starBroadcast.setBody(message)\n    const networkMessage = new NetworkMessage()\n    networkMessage.setStarBroadcast(starBroadcast)\n    networkMessage.setNetworkId(this.id)\n    const rawNetworkMessage = networkMessage.serializeBinary()\n\n    if (this.isHub) {\n      this.forwardBroadcast(this.peerPool.peerId, rawNetworkMessage)\n    } else {\n      this.peerPool.send(this.hubId, rawNetworkMessage)\n    }\n  }\n\n  onPeerJoin (callback) {\n    return this.emitter.on('join', callback)\n  }\n\n  onPeerLeave (callback) {\n    return this.emitter.on('leave', callback)\n  }\n\n  onReceive (callback) {\n    return this.emitter.on('receive', callback)\n  }\n\n  getMembers () {\n    const members = new Set()\n    this.members.forEach((user, peerId) => {\n      members.add({peerId, username: user.username})\n    })\n    return members\n  }\n\n  getPeerId () {\n    return this.peerPool.peerId\n  }\n\n  receive ({senderId, message}) {\n    const networkMessage = NetworkMessage.deserializeBinary(message)\n    if (networkMessage.getNetworkId() !== this.id) return\n\n    if (networkMessage.hasStarConnection()) {\n      this.receiveConnection(message, networkMessage.getStarConnection())\n    } else if (networkMessage.hasStarConnectionAck()) {\n      this.receiveConnectionAck(networkMessage.getStarConnectionAck())\n    } else if (networkMessage.hasStarDisconnection()) {\n      this.receiveDisconnection(message, networkMessage.getStarDisconnection())\n    } else if (networkMessage.hasStarUnicast()) {\n      this.receiveUnicast(message, networkMessage.getStarUnicast())\n    } else if (networkMessage.hasStarBroadcast()) {\n      this.receiveBroadcast(message, networkMessage.getStarBroadcast())\n    }\n  }\n\n  receiveConnection (rawMessage, connectionMessage) {\n    const senderId = connectionMessage.getSenderId()\n\n    if (this.isHub) {\n      this.connected = true\n      this.spokes.add(senderId)\n\n      const networkMembers = []\n      this.getMembers().forEach((member) => {\n        const networkMember = new NetworkMember()\n        networkMember.setPeerId(member.peerId)\n        networkMember.setUsername(member.username)\n        networkMembers.push(networkMember)\n      })\n\n      const connectionAck = new NetworkMessage.StarConnectionAck()\n      connectionAck.setMembersList(networkMembers)\n      const ackNetworkMessage = new NetworkMessage()\n      ackNetworkMessage.setNetworkId(this.id)\n      ackNetworkMessage.setStarConnectionAck(connectionAck)\n      this.peerPool.send(senderId, ackNetworkMessage.serializeBinary())\n\n      const starJoinNotification = new NetworkMessage.StarJoinNotification()\n      const networkMember = new NetworkMember()\n        networkMember.setUsername(member.username)\nsenderIdthis.peerPool.getUser(senderId)\n      starJoinNotification.setNetworkMember()networkMember\n      const shart\nstarJoinNetworkMessage = new NetworkMessage.StarJoinNotification()\n      starJoinNetworkMessage.setNetworkId()this.id\n      starJoinNetworkMessage.setStarJoinNotification()starJoinNotification\n      this(starJoinNetworkMessage.serializeBinary())\nwMessage)\n    }\nstarJoinNetworkMessage.serializeBinary()    connectionMessage.getMember\n\n    this.members.set(senderId, this.peerPool.getUser(senderId))\n    this.emitter.emit('join', {peerId: senderId})\n  }\n\n  receiveConnectionAck (connectionAckMessage) {\n    assert(!this.isHub, 'Connection acknowledgments cannot be sent to the hub')\n    const networkMembers = connectionAckMessage.getMembersList()\n    for (let i = 0; i < networkMembers.length; i++) {\n      const networkMember = networkMembers[i]\n      this.members.set(networkMember.getPeerId(), this.peerPool.getUser(networkMember.getPeerId()))\n    }\n\n    this.resolveConnectionPromise()\n    this.resolveConnectionPromise = null\n    this.connected = true\n  }\n\n  didLoseConnectionToPeer ({peerId}) {\n    if (this.isHub) {\n      this.spokes.delete(peerId)\n\n      const starDisconnection = new NetworkMessage.StarDisconnection()\n      starDisconnection.setSenderId(peerId)\n      starDisconnection.setConnectionLost(true)\n      const networkMessage = new NetworkMessage()\n      networkMessage.setStarDisconnection(starDisconnection)\n      networkMessage.setNetworkId(this.id)\n      this.forwardBroadcast(peerId, networkMessage.serializeBinary())\n    }\n\n    this.handleDisconnection(peerId, true)\n  }\n\n  receiveDisconnection (rawMessage, disconnectionMessage) {\n    const peerId = disconnectionMessage.getSenderId()\n    if (this.isHub) {\n      this.spokes.delete(peerId)\n      this.forwardBroadcast(peerId, rawMessage)\n    }\n\n    this.handleDisconnection(peerId, disconnectionMessage.getConnectionLost())\n  }\n\n  receiveUnicast (rawMessage, unicastMessage) {\n    const recipientId = unicastMessage.getRecipientId()\n    if (recipientId === this.peerPool.peerId) {\n      this.emitter.emit('receive', {\n        senderId: unicastMessage.getSenderId(),\n        message: convertToProtobufCompatibleBuffer(unicastMessage.getBody())\n      })\n    } else if (this.isHub) {\n      this.forwardUnicast(recipientId, rawMessage)\n    } else {\n      throw new Error('Received a unicast not intended for this peer')\n    }\n  }\n\n  receiveBroadcast (rawMessage, broadcastMessage) {\n    const senderId = broadcastMessage.getSenderId()\n    if (this.isHub) this.forwardBroadcast(senderId, rawMessage)\n    this.emitter.emit('receive', {\n      senderId,\n      message: convertToProtobufCompatibleBuffer(broadcastMessage.getBody())\n    })\n  }\n\n  forwardUnicast (recipientId, rawMessage) {\n    if (this.spokes.has(recipientId)) {\n      this.peerPool.send(recipientId, rawMessage)\n    }\n  }\n\n  forwardBroadcast (senderId, rawMessage) {\n    this.spokes.forEach((peerId) => {\n      if (peerId !== senderId) {\n        this.peerPool.send(peerId, rawMessage)\n      }\n    })\n  }\n\n  handleDisconnection (peerId, connectionLost) {\n    if (peerId === this.hubId) {\n      this.hubId = null\n      this.connected = false\n      this.members.set(this.getPeerId(), this.peerPool.getUser(this.getPeerId()))\n    } else {\n      this.members.delete(peerId)\n    }\n\n    this.emitter.emit('leave', {peerId, connectionLost})\n  }\n}\n"}